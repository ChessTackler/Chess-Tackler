<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chess Tackler</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
    }
    .header {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      width: 100%;
      max-width: 600px;
      background-color: #333;
      color: white;
    }
    .header img {
      width: 32px;
      height: 32px;
      margin-right: 10px;
    }
    .header h1 {
      font-size: 20px;
      margin: 0;
    }
    .history {
      width: 95%;
      max-width: 400px;
      margin: 10px auto;
      padding: 5px;
      background-color: #eee;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      text-align: center;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(8, 40px);
      grid-template-rows: repeat(8, 40px);
      border: 2px solid #333;
      margin: 10px 0;
    }
    .square {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .light { background-color: #f0d9b5; }
    .dark { background-color: #b58863; }
    .highlight { outline: 2px solid yellow; }
    .piece {
      max-width: 90%;
      max-height: 90%;
      cursor: grab;
      user-select: none;
    }
    .checkmate-message {
      font-size: 18px;
      font-weight: bold;
      color: red;
      margin-top: 10px;
    }
    .nav-buttons {
      margin: 8px;
    }
    .nav-buttons button {
      background-color: transparent;
      border: none;
      font-size: 24px;
      cursor: pointer;
      margin: 0 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="CT logo.png" alt="CT Logo" />
    <h1>Chess Board ‚Äì Chess Tackler</h1>
  </div>
  <div class="history" id="moveHistory"></div>
  <div class="board" id="chessBoard"></div>
  <div class="nav-buttons">
    <button id="prevBtn">&#x25C0;</button>
    <button id="nextBtn">&#x25B6;</button>
  </div>
  <div class="checkmate-message" id="checkmateMessage"></div>
  <audio id="checkmateAudio" src="correct.mp3" preload="auto"></audio>

  <script>
    const boardElement = document.getElementById("chessBoard");
    const moveHistoryElement = document.getElementById("moveHistory");
    const checkmateMessage = document.getElementById("checkmateMessage");
    const checkmateAudio = document.getElementById("checkmateAudio");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    let boardState = [];
    let moveHistory = [];
    let currentTurn = 'w';
    let selected = null;
    let gameOver = false;
    let historyIndex = -1;

    function initializeBoard() {
      const initial = [
        ["bR", "bN", "bB", "bQ", "bK", "bB", "bN", "bR"],
        Array(8).fill("bP"),
        ...Array(4).fill(Array(8).fill(null)),
        Array(8).fill("wP"),
        ["wR", "wN", "wB", "wQ", "wK", "wB", "wN", "wR"]
      ];
      boardState = JSON.parse(JSON.stringify(initial));
      moveHistory = [];
      historyIndex = -1;
    }

    function renderBoard() {
      boardElement.innerHTML = "";
      for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
          const square = document.createElement("div");
          square.className = `square ${(r + c) % 2 === 0 ? "light" : "dark"}`;
          square.dataset.row = r;
          square.dataset.col = c;

          const piece = boardState[r][c];
          if (piece) {
            const img = document.createElement("img");
            img.src = `${piece}.png`;
            img.className = "piece";
            img.draggable = true;
            img.addEventListener("dragstart", (e) => {
              e.dataTransfer.setData("fromRow", r);
              e.dataTransfer.setData("fromCol", c);
            });
            square.appendChild(img);
          }

          square.addEventListener("click", () => onSquareClick(r, c));
          square.addEventListener("dragover", (e) => e.preventDefault());
          square.addEventListener("drop", (e) => {
            e.preventDefault();
            const fromRow = parseInt(e.dataTransfer.getData("fromRow"));
            const fromCol = parseInt(e.dataTransfer.getData("fromCol"));
            tryMove(fromRow, fromCol, r, c);
          });

          boardElement.appendChild(square);
        }
      }
    }

    function onSquareClick(r, c) {
      if (gameOver) return;
      if (selected) {
        const [sr, sc] = selected;
        tryMove(sr, sc, r, c);
        selected = null;
      } else if (boardState[r][c] && boardState[r][c][0] === currentTurn) {
        selected = [r, c];
      }
    }

    function tryMove(fr, fc, tr, tc) {
      const piece = boardState[fr][fc];
      if (!piece || piece[0] !== currentTurn || gameOver) return;

      if (!isLegalMove(piece, fr, fc, tr, tc)) return;

      const backup = JSON.parse(JSON.stringify(boardState));
      boardState[tr][tc] = piece;
      boardState[fr][fc] = null;

      moveHistory = moveHistory.slice(0, historyIndex + 1);
      moveHistory.push(backup);
      historyIndex++;

      currentTurn = currentTurn === 'w' ? 'b' : 'w';
      renderBoard();
      moveHistoryElement.textContent = `Moves: ${historyIndex + 1}`;

      if (isCheckmate(currentTurn)) {
        checkmateMessage.textContent = `Checkmate! Player ${currentTurn === 'w' ? 'Black' : 'White'} wins.`;
        alert("Checkmate!");
        checkmateAudio.play();
        gameOver = true;
      }
    }

    function isLegalMove(piece, fr, fc, tr, tc) {
      const target = boardState[tr][tc];
      if (target && target[0] === piece[0]) return false;
      const dr = tr - fr, dc = tc - fc;
      switch (piece[1]) {
        case 'P': {
          const dir = piece[0] === 'w' ? -1 : 1;
          const start = piece[0] === 'w' ? 6 : 1;
          if (dc === 0 && !target) {
            if (dr === dir || (dr === 2 * dir && fr === start && !boardState[fr + dir][fc])) return true;
          } else if (Math.abs(dc) === 1 && dr === dir && target && target[0] !== piece[0]) return true;
          break;
        }
        case 'R': if (dr === 0 || dc === 0) return isClear(fr, fc, tr, tc); break;
        case 'N': if ((Math.abs(dr) === 2 && Math.abs(dc) === 1) || (Math.abs(dr) === 1 && Math.abs(dc) === 2)) return true; break;
        case 'B': if (Math.abs(dr) === Math.abs(dc)) return isClear(fr, fc, tr, tc); break;
        case 'Q': if (dr === 0 || dc === 0 || Math.abs(dr) === Math.abs(dc)) return isClear(fr, fc, tr, tc); break;
        case 'K': if (Math.abs(dr) <= 1 && Math.abs(dc) <= 1) return true; break;
      }
      return false;
    }

    function isClear(fr, fc, tr, tc) {
      const dr = Math.sign(tr - fr), dc = Math.sign(tc - fc);
      let r = fr + dr, c = fc + dc;
      while (r !== tr || c !== tc) {
        if (boardState[r][c]) return false;
        r += dr; c += dc;
      }
      return true;
    }

    function isCheckmate(color) {
      for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
          const piece = boardState[r][c];
          if (piece && piece[0] === color) {
            for (let tr = 0; tr < 8; tr++) {
              for (let tc = 0; tc < 8; tc++) {
                const temp = boardState[tr][tc];
                const orig = boardState[r][c];
                if (isLegalMove(orig, r, c, tr, tc)) {
                  boardState[tr][tc] = orig;
                  boardState[r][c] = null;
                  const safe = !inCheck(color);
                  boardState[r][c] = orig;
                  boardState[tr][tc] = temp;
                  if (safe) return false;
                }
              }
            }
          }
        }
      }
      return true;
    }

    function inCheck(color) {
      let kr = -1, kc = -1;
      for (let r = 0; r < 8; r++)
        for (let c = 0; c < 8; c++)
          if (boardState[r][c] === color + 'K') [kr, kc] = [r, c];
      const opp = color === 'w' ? 'b' : 'w';
      for (let r = 0; r < 8; r++)
        for (let c = 0; c < 8; c++)
          if (boardState[r][c]?.[0] === opp)
            if (isLegalMove(boardState[r][c], r, c, kr, kc)) return true;
      return false;
    }

    prevBtn.onclick = () => {
      if (historyIndex >= 0) {
        boardState = moveHistory[historyIndex];
        historyIndex--;
        currentTurn = currentTurn === 'w' ? 'b' : 'w';
        gameOver = false;
        checkmateMessage.textContent = "";
        renderBoard();
      }
    };

    nextBtn.onclick = () => {
      if (historyIndex + 1 < moveHistory.length) {
        historyIndex++;
        boardState = JSON.parse(JSON.stringify(moveHistory[historyIndex]));
        currentTurn = currentTurn === 'w' ? 'b' : 'w';
        gameOver = false;
        checkmateMessage.textContent = "";
        renderBoard();
      }
    };

    initializeBoard();
    renderBoard();
  </script>
</body>
</html>


‚úÖ The drag-and-drop issue has been resolved and both drag-and-drop and click-to-move features now work correctly.

üîÅ Also, the Back and Next buttons with icons are fully functional.

üîî On checkmate:

An alert appears,

"correct.mp3" is played,

A text notice is shown (Checkmate! Player ... wins.)


Let me know if you'd like:

Multiplayer support

AI opponent

Timers or scoring

Dark mode or visual effects


